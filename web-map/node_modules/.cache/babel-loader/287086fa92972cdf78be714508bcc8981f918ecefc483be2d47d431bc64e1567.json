{"ast":null,"code":"import axios from 'axios';\nimport config from '../config/config';\nconst API_URL = config.API_SIGNALEMENTS_URL;\n\n/**\r\n * Service pour gérer les signalements\r\n * Note: Pour l'instant, utilise des données mockées\r\n * À remplacer par de vraies requêtes API quand le backend sera prêt\r\n */\n\n// Données mockées pour le développement\nconst mockSignalements = [{\n  id_signalement: '1',\n  description: 'Nid de poule important - Avenue de l\\'Indépendance',\n  latitude: -18.8792,\n  longitude: 47.5079,\n  date_signalement: '2026-01-15',\n  id_statut: 1,\n  surface_m2: 15.5,\n  budget: 250000,\n  entreprise_nom: 'BTP Madagascar'\n}, {\n  id_signalement: '2',\n  description: 'Route dégradée - Rue Rainitovo',\n  latitude: -18.8850,\n  longitude: 47.5150,\n  date_signalement: '2026-01-10',\n  id_statut: 2,\n  surface_m2: 45.0,\n  budget: 750000,\n  entreprise_nom: 'Colas Madagascar'\n}, {\n  id_signalement: '3',\n  description: 'Affaissement de chaussée - Boulevard Ratsimilaho',\n  latitude: -18.8720,\n  longitude: 47.5000,\n  date_signalement: '2025-12-20',\n  id_statut: 3,\n  surface_m2: 28.0,\n  budget: 450000,\n  entreprise_nom: 'SOGEA SATOM'\n}, {\n  id_signalement: '4',\n  description: 'Fissures multiples - Rue Dr Raseta',\n  latitude: -18.8900,\n  longitude: 47.5200,\n  date_signalement: '2026-01-18',\n  id_statut: 1,\n  surface_m2: 32.5,\n  budget: 500000,\n  entreprise_nom: null\n}, {\n  id_signalement: '5',\n  description: 'Réfection totale - Avenue de France',\n  latitude: -18.8750,\n  longitude: 47.5100,\n  date_signalement: '2025-11-15',\n  id_statut: 2,\n  surface_m2: 120.0,\n  budget: 2500000,\n  entreprise_nom: 'Colas Madagascar'\n}];\nconst mockEntreprises = [{\n  id_entreprise: 1,\n  nom: 'BTP Madagascar',\n  contact: 'contact@btp-mada.mg'\n}, {\n  id_entreprise: 2,\n  nom: 'Colas Madagascar',\n  contact: 'info@colas.mg'\n}, {\n  id_entreprise: 3,\n  nom: 'SOGEA SATOM',\n  contact: 'contact@sogea-satom.mg'\n}, {\n  id_entreprise: 4,\n  nom: 'RAVINALA TP',\n  contact: 'ravinala@tp.mg'\n}];\nconst mockBlockedUsers = [{\n  id_user: 1,\n  email: 'user1@test.com',\n  firstname: 'Jean',\n  lastname: 'Dupont',\n  attempts: 3\n}, {\n  id_user: 2,\n  email: 'user2@test.com',\n  firstname: 'Marie',\n  lastname: 'Martin',\n  attempts: 5\n}];\nconst signalementService = {\n  /**\r\n   * Récupérer tous les signalements\r\n   */\n  getAll: async () => {\n    // TODO: Remplacer par un vrai appel API\n    // const response = await axios.get(`${API_URL}/signalements`);\n    // return response.data;\n\n    return new Promise(resolve => {\n      setTimeout(() => resolve(mockSignalements), 500);\n    });\n  },\n  /**\r\n   * Récupérer un signalement par ID\r\n   */\n  getById: async id => {\n    // TODO: Remplacer par un vrai appel API\n    return new Promise(resolve => {\n      setTimeout(() => {\n        resolve(mockSignalements.find(s => s.id_signalement === id));\n      }, 300);\n    });\n  },\n  /**\r\n   * Mettre à jour un signalement\r\n   */\n  update: async (id, data) => {\n    // TODO: Remplacer par un vrai appel API\n    // const response = await axios.put(`${API_URL}/signalements/${id}`, data);\n    // return response.data;\n\n    return new Promise(resolve => {\n      const index = mockSignalements.findIndex(s => s.id_signalement === id);\n      if (index !== -1) {\n        mockSignalements[index] = {\n          ...mockSignalements[index],\n          ...data\n        };\n      }\n      setTimeout(() => resolve(mockSignalements[index]), 300);\n    });\n  },\n  /**\r\n   * Calculer les statistiques de récapitulation\r\n   */\n  getStats: async () => {\n    const signalements = await signalementService.getAll();\n    const totalPoints = signalements.length;\n    const totalSurface = signalements.reduce((sum, s) => sum + (s.surface_m2 || 0), 0);\n    const totalBudget = signalements.reduce((sum, s) => sum + (s.budget || 0), 0);\n    const termines = signalements.filter(s => s.id_statut === 3).length;\n    const avancement = totalPoints > 0 ? termines / totalPoints * 100 : 0;\n    return {\n      totalPoints,\n      totalSurface,\n      totalBudget,\n      avancement: avancement.toFixed(1)\n    };\n  },\n  /**\r\n   * Récupérer la liste des entreprises\r\n   */\n  getEntreprises: async () => {\n    // TODO: Remplacer par un vrai appel API\n    return new Promise(resolve => {\n      setTimeout(() => resolve(mockEntreprises), 300);\n    });\n  },\n  /**\r\n   * Récupérer les utilisateurs bloqués\r\n   */\n  getBlockedUsers: async () => {\n    // TODO: Remplacer par un vrai appel API\n    return new Promise(resolve => {\n      setTimeout(() => resolve(mockBlockedUsers), 300);\n    });\n  },\n  /**\r\n   * Synchroniser avec Firebase\r\n   */\n  syncWithFirebase: async () => {\n    // TODO: Implémenter la synchronisation avec Firebase\n    return new Promise(resolve => {\n      setTimeout(() => resolve({\n        message: 'Synchronisation réussie',\n        synced: 5\n      }), 1000);\n    });\n  }\n};\nexport default signalementService;","map":{"version":3,"names":["axios","config","API_URL","API_SIGNALEMENTS_URL","mockSignalements","id_signalement","description","latitude","longitude","date_signalement","id_statut","surface_m2","budget","entreprise_nom","mockEntreprises","id_entreprise","nom","contact","mockBlockedUsers","id_user","email","firstname","lastname","attempts","signalementService","getAll","Promise","resolve","setTimeout","getById","id","find","s","update","data","index","findIndex","getStats","signalements","totalPoints","length","totalSurface","reduce","sum","totalBudget","termines","filter","avancement","toFixed","getEntreprises","getBlockedUsers","syncWithFirebase","message","synced"],"sources":["D:/L3/Mr Rojo/cloud/web-map/src/services/signalementService.js"],"sourcesContent":["import axios from 'axios';\r\nimport config from '../config/config';\r\n\r\nconst API_URL = config.API_SIGNALEMENTS_URL;\r\n\r\n/**\r\n * Service pour gérer les signalements\r\n * Note: Pour l'instant, utilise des données mockées\r\n * À remplacer par de vraies requêtes API quand le backend sera prêt\r\n */\r\n\r\n// Données mockées pour le développement\r\nconst mockSignalements = [\r\n  {\r\n    id_signalement: '1',\r\n    description: 'Nid de poule important - Avenue de l\\'Indépendance',\r\n    latitude: -18.8792,\r\n    longitude: 47.5079,\r\n    date_signalement: '2026-01-15',\r\n    id_statut: 1,\r\n    surface_m2: 15.5,\r\n    budget: 250000,\r\n    entreprise_nom: 'BTP Madagascar'\r\n  },\r\n  {\r\n    id_signalement: '2',\r\n    description: 'Route dégradée - Rue Rainitovo',\r\n    latitude: -18.8850,\r\n    longitude: 47.5150,\r\n    date_signalement: '2026-01-10',\r\n    id_statut: 2,\r\n    surface_m2: 45.0,\r\n    budget: 750000,\r\n    entreprise_nom: 'Colas Madagascar'\r\n  },\r\n  {\r\n    id_signalement: '3',\r\n    description: 'Affaissement de chaussée - Boulevard Ratsimilaho',\r\n    latitude: -18.8720,\r\n    longitude: 47.5000,\r\n    date_signalement: '2025-12-20',\r\n    id_statut: 3,\r\n    surface_m2: 28.0,\r\n    budget: 450000,\r\n    entreprise_nom: 'SOGEA SATOM'\r\n  },\r\n  {\r\n    id_signalement: '4',\r\n    description: 'Fissures multiples - Rue Dr Raseta',\r\n    latitude: -18.8900,\r\n    longitude: 47.5200,\r\n    date_signalement: '2026-01-18',\r\n    id_statut: 1,\r\n    surface_m2: 32.5,\r\n    budget: 500000,\r\n    entreprise_nom: null\r\n  },\r\n  {\r\n    id_signalement: '5',\r\n    description: 'Réfection totale - Avenue de France',\r\n    latitude: -18.8750,\r\n    longitude: 47.5100,\r\n    date_signalement: '2025-11-15',\r\n    id_statut: 2,\r\n    surface_m2: 120.0,\r\n    budget: 2500000,\r\n    entreprise_nom: 'Colas Madagascar'\r\n  }\r\n];\r\n\r\nconst mockEntreprises = [\r\n  { id_entreprise: 1, nom: 'BTP Madagascar', contact: 'contact@btp-mada.mg' },\r\n  { id_entreprise: 2, nom: 'Colas Madagascar', contact: 'info@colas.mg' },\r\n  { id_entreprise: 3, nom: 'SOGEA SATOM', contact: 'contact@sogea-satom.mg' },\r\n  { id_entreprise: 4, nom: 'RAVINALA TP', contact: 'ravinala@tp.mg' }\r\n];\r\n\r\nconst mockBlockedUsers = [\r\n  { id_user: 1, email: 'user1@test.com', firstname: 'Jean', lastname: 'Dupont', attempts: 3 },\r\n  { id_user: 2, email: 'user2@test.com', firstname: 'Marie', lastname: 'Martin', attempts: 5 }\r\n];\r\n\r\nconst signalementService = {\r\n  /**\r\n   * Récupérer tous les signalements\r\n   */\r\n  getAll: async () => {\r\n    // TODO: Remplacer par un vrai appel API\r\n    // const response = await axios.get(`${API_URL}/signalements`);\r\n    // return response.data;\r\n    \r\n    return new Promise((resolve) => {\r\n      setTimeout(() => resolve(mockSignalements), 500);\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Récupérer un signalement par ID\r\n   */\r\n  getById: async (id) => {\r\n    // TODO: Remplacer par un vrai appel API\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        resolve(mockSignalements.find(s => s.id_signalement === id));\r\n      }, 300);\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Mettre à jour un signalement\r\n   */\r\n  update: async (id, data) => {\r\n    // TODO: Remplacer par un vrai appel API\r\n    // const response = await axios.put(`${API_URL}/signalements/${id}`, data);\r\n    // return response.data;\r\n    \r\n    return new Promise((resolve) => {\r\n      const index = mockSignalements.findIndex(s => s.id_signalement === id);\r\n      if (index !== -1) {\r\n        mockSignalements[index] = { ...mockSignalements[index], ...data };\r\n      }\r\n      setTimeout(() => resolve(mockSignalements[index]), 300);\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Calculer les statistiques de récapitulation\r\n   */\r\n  getStats: async () => {\r\n    const signalements = await signalementService.getAll();\r\n    \r\n    const totalPoints = signalements.length;\r\n    const totalSurface = signalements.reduce((sum, s) => sum + (s.surface_m2 || 0), 0);\r\n    const totalBudget = signalements.reduce((sum, s) => sum + (s.budget || 0), 0);\r\n    \r\n    const termines = signalements.filter(s => s.id_statut === 3).length;\r\n    const avancement = totalPoints > 0 ? (termines / totalPoints) * 100 : 0;\r\n    \r\n    return {\r\n      totalPoints,\r\n      totalSurface,\r\n      totalBudget,\r\n      avancement: avancement.toFixed(1)\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Récupérer la liste des entreprises\r\n   */\r\n  getEntreprises: async () => {\r\n    // TODO: Remplacer par un vrai appel API\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => resolve(mockEntreprises), 300);\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Récupérer les utilisateurs bloqués\r\n   */\r\n  getBlockedUsers: async () => {\r\n    // TODO: Remplacer par un vrai appel API\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => resolve(mockBlockedUsers), 300);\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Synchroniser avec Firebase\r\n   */\r\n  syncWithFirebase: async () => {\r\n    // TODO: Implémenter la synchronisation avec Firebase\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => resolve({ message: 'Synchronisation réussie', synced: 5 }), 1000);\r\n    });\r\n  }\r\n};\r\n\r\nexport default signalementService;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,kBAAkB;AAErC,MAAMC,OAAO,GAAGD,MAAM,CAACE,oBAAoB;;AAE3C;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAMC,gBAAgB,GAAG,CACvB;EACEC,cAAc,EAAE,GAAG;EACnBC,WAAW,EAAE,oDAAoD;EACjEC,QAAQ,EAAE,CAAC,OAAO;EAClBC,SAAS,EAAE,OAAO;EAClBC,gBAAgB,EAAE,YAAY;EAC9BC,SAAS,EAAE,CAAC;EACZC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE,MAAM;EACdC,cAAc,EAAE;AAClB,CAAC,EACD;EACER,cAAc,EAAE,GAAG;EACnBC,WAAW,EAAE,gCAAgC;EAC7CC,QAAQ,EAAE,CAAC,OAAO;EAClBC,SAAS,EAAE,OAAO;EAClBC,gBAAgB,EAAE,YAAY;EAC9BC,SAAS,EAAE,CAAC;EACZC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE,MAAM;EACdC,cAAc,EAAE;AAClB,CAAC,EACD;EACER,cAAc,EAAE,GAAG;EACnBC,WAAW,EAAE,kDAAkD;EAC/DC,QAAQ,EAAE,CAAC,OAAO;EAClBC,SAAS,EAAE,OAAO;EAClBC,gBAAgB,EAAE,YAAY;EAC9BC,SAAS,EAAE,CAAC;EACZC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE,MAAM;EACdC,cAAc,EAAE;AAClB,CAAC,EACD;EACER,cAAc,EAAE,GAAG;EACnBC,WAAW,EAAE,oCAAoC;EACjDC,QAAQ,EAAE,CAAC,OAAO;EAClBC,SAAS,EAAE,OAAO;EAClBC,gBAAgB,EAAE,YAAY;EAC9BC,SAAS,EAAE,CAAC;EACZC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE,MAAM;EACdC,cAAc,EAAE;AAClB,CAAC,EACD;EACER,cAAc,EAAE,GAAG;EACnBC,WAAW,EAAE,qCAAqC;EAClDC,QAAQ,EAAE,CAAC,OAAO;EAClBC,SAAS,EAAE,OAAO;EAClBC,gBAAgB,EAAE,YAAY;EAC9BC,SAAS,EAAE,CAAC;EACZC,UAAU,EAAE,KAAK;EACjBC,MAAM,EAAE,OAAO;EACfC,cAAc,EAAE;AAClB,CAAC,CACF;AAED,MAAMC,eAAe,GAAG,CACtB;EAAEC,aAAa,EAAE,CAAC;EAAEC,GAAG,EAAE,gBAAgB;EAAEC,OAAO,EAAE;AAAsB,CAAC,EAC3E;EAAEF,aAAa,EAAE,CAAC;EAAEC,GAAG,EAAE,kBAAkB;EAAEC,OAAO,EAAE;AAAgB,CAAC,EACvE;EAAEF,aAAa,EAAE,CAAC;EAAEC,GAAG,EAAE,aAAa;EAAEC,OAAO,EAAE;AAAyB,CAAC,EAC3E;EAAEF,aAAa,EAAE,CAAC;EAAEC,GAAG,EAAE,aAAa;EAAEC,OAAO,EAAE;AAAiB,CAAC,CACpE;AAED,MAAMC,gBAAgB,GAAG,CACvB;EAAEC,OAAO,EAAE,CAAC;EAAEC,KAAK,EAAE,gBAAgB;EAAEC,SAAS,EAAE,MAAM;EAAEC,QAAQ,EAAE,QAAQ;EAAEC,QAAQ,EAAE;AAAE,CAAC,EAC3F;EAAEJ,OAAO,EAAE,CAAC;EAAEC,KAAK,EAAE,gBAAgB;EAAEC,SAAS,EAAE,OAAO;EAAEC,QAAQ,EAAE,QAAQ;EAAEC,QAAQ,EAAE;AAAE,CAAC,CAC7F;AAED,MAAMC,kBAAkB,GAAG;EACzB;AACF;AACA;EACEC,MAAM,EAAE,MAAAA,CAAA,KAAY;IAClB;IACA;IACA;;IAEA,OAAO,IAAIC,OAAO,CAAEC,OAAO,IAAK;MAC9BC,UAAU,CAAC,MAAMD,OAAO,CAACvB,gBAAgB,CAAC,EAAE,GAAG,CAAC;IAClD,CAAC,CAAC;EACJ,CAAC;EAED;AACF;AACA;EACEyB,OAAO,EAAE,MAAOC,EAAE,IAAK;IACrB;IACA,OAAO,IAAIJ,OAAO,CAAEC,OAAO,IAAK;MAC9BC,UAAU,CAAC,MAAM;QACfD,OAAO,CAACvB,gBAAgB,CAAC2B,IAAI,CAACC,CAAC,IAAIA,CAAC,CAAC3B,cAAc,KAAKyB,EAAE,CAAC,CAAC;MAC9D,CAAC,EAAE,GAAG,CAAC;IACT,CAAC,CAAC;EACJ,CAAC;EAED;AACF;AACA;EACEG,MAAM,EAAE,MAAAA,CAAOH,EAAE,EAAEI,IAAI,KAAK;IAC1B;IACA;IACA;;IAEA,OAAO,IAAIR,OAAO,CAAEC,OAAO,IAAK;MAC9B,MAAMQ,KAAK,GAAG/B,gBAAgB,CAACgC,SAAS,CAACJ,CAAC,IAAIA,CAAC,CAAC3B,cAAc,KAAKyB,EAAE,CAAC;MACtE,IAAIK,KAAK,KAAK,CAAC,CAAC,EAAE;QAChB/B,gBAAgB,CAAC+B,KAAK,CAAC,GAAG;UAAE,GAAG/B,gBAAgB,CAAC+B,KAAK,CAAC;UAAE,GAAGD;QAAK,CAAC;MACnE;MACAN,UAAU,CAAC,MAAMD,OAAO,CAACvB,gBAAgB,CAAC+B,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC;IACzD,CAAC,CAAC;EACJ,CAAC;EAED;AACF;AACA;EACEE,QAAQ,EAAE,MAAAA,CAAA,KAAY;IACpB,MAAMC,YAAY,GAAG,MAAMd,kBAAkB,CAACC,MAAM,CAAC,CAAC;IAEtD,MAAMc,WAAW,GAAGD,YAAY,CAACE,MAAM;IACvC,MAAMC,YAAY,GAAGH,YAAY,CAACI,MAAM,CAAC,CAACC,GAAG,EAAEX,CAAC,KAAKW,GAAG,IAAIX,CAAC,CAACrB,UAAU,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;IAClF,MAAMiC,WAAW,GAAGN,YAAY,CAACI,MAAM,CAAC,CAACC,GAAG,EAAEX,CAAC,KAAKW,GAAG,IAAIX,CAAC,CAACpB,MAAM,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;IAE7E,MAAMiC,QAAQ,GAAGP,YAAY,CAACQ,MAAM,CAACd,CAAC,IAAIA,CAAC,CAACtB,SAAS,KAAK,CAAC,CAAC,CAAC8B,MAAM;IACnE,MAAMO,UAAU,GAAGR,WAAW,GAAG,CAAC,GAAIM,QAAQ,GAAGN,WAAW,GAAI,GAAG,GAAG,CAAC;IAEvE,OAAO;MACLA,WAAW;MACXE,YAAY;MACZG,WAAW;MACXG,UAAU,EAAEA,UAAU,CAACC,OAAO,CAAC,CAAC;IAClC,CAAC;EACH,CAAC;EAED;AACF;AACA;EACEC,cAAc,EAAE,MAAAA,CAAA,KAAY;IAC1B;IACA,OAAO,IAAIvB,OAAO,CAAEC,OAAO,IAAK;MAC9BC,UAAU,CAAC,MAAMD,OAAO,CAACb,eAAe,CAAC,EAAE,GAAG,CAAC;IACjD,CAAC,CAAC;EACJ,CAAC;EAED;AACF;AACA;EACEoC,eAAe,EAAE,MAAAA,CAAA,KAAY;IAC3B;IACA,OAAO,IAAIxB,OAAO,CAAEC,OAAO,IAAK;MAC9BC,UAAU,CAAC,MAAMD,OAAO,CAACT,gBAAgB,CAAC,EAAE,GAAG,CAAC;IAClD,CAAC,CAAC;EACJ,CAAC;EAED;AACF;AACA;EACEiC,gBAAgB,EAAE,MAAAA,CAAA,KAAY;IAC5B;IACA,OAAO,IAAIzB,OAAO,CAAEC,OAAO,IAAK;MAC9BC,UAAU,CAAC,MAAMD,OAAO,CAAC;QAAEyB,OAAO,EAAE,yBAAyB;QAAEC,MAAM,EAAE;MAAE,CAAC,CAAC,EAAE,IAAI,CAAC;IACpF,CAAC,CAAC;EACJ;AACF,CAAC;AAED,eAAe7B,kBAAkB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}